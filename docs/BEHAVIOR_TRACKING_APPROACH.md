# 행태감지 시스템 구현 방식 비교

## 1. 일반적인 행태감지 시스템 구현 방식

### 1.1 클라이언트 사이드 추적 (현재 방식)
**대표 사례**: Google Analytics, Mixpanel, Amplitude, Hotjar

**구현 방식**:
- JavaScript SDK를 클라이언트에 삽입
- 이벤트 리스너로 사용자 행동 추적
- 배치 전송 (30초~5분 간격)
- 실시간 전송 (중요 이벤트)

**장점**:
- ✅ 실시간 데이터 수집
- ✅ 사용자 경험에 영향 최소화
- ✅ 클라이언트 측에서 즉시 처리 가능
- ✅ 서버 부하 분산

**단점**:
- ❌ 브라우저 확장 프로그램으로 차단 가능
- ❌ 네트워크 오류 시 데이터 손실 가능
- ❌ 클라이언트 측 데이터 조작 가능

### 1.2 서버 사이드 추적
**대표 사례**: 로그 분석 시스템, 백엔드 이벤트 추적

**구현 방식**:
- 서버 로그 수집
- API 엔드포인트에서 이벤트 기록
- 서버 측 세션 관리

**장점**:
- ✅ 데이터 조작 불가능
- ✅ 보안성 높음
- ✅ 모든 요청 추적 가능

**단점**:
- ❌ 클라이언트 측 상호작용 추적 어려움
- ❌ 서버 부하 증가
- ❌ 실시간 분석 제한적

### 1.3 하이브리드 방식
**대표 사례**: Adobe Analytics, Segment

**구현 방식**:
- 클라이언트에서 이벤트 수집
- 서버로 전송하여 검증 및 저장
- 양쪽 데이터 병합 분석

**장점**:
- ✅ 데이터 정확성 향상
- ✅ 보안성과 실시간성 균형

**단점**:
- ❌ 구현 복잡도 증가
- ❌ 인프라 비용 증가

## 2. 현재 프로젝트의 구현 방식

### 2.1 클라이언트 사이드 추적
```typescript
// app/behavior/tracker.ts
class BehaviorTracker {
  // 이벤트 리스너로 행동 추적
  // 30초마다 배치 전송
  // localStorage + 로컬 API
}
```

**일반적인 방식과의 비교**:
- ✅ 표준적인 클라이언트 사이드 추적 방식
- ✅ 배치 전송으로 네트워크 효율성 확보
- ✅ localStorage로 오프라인 지원

### 2.2 빌드 스크립트 처리 (특수한 경우)

**현재 사용하는 스크립트**:
```javascript
// scripts/prepare-build.js
// API 라우트를 빌드에서 제외하기 위해 임시 이동
```

**이 방식이 필요한 이유**:
- Next.js `output: 'export'` (정적 사이트 생성) 사용
- GitHub Pages는 정적 호스팅만 지원
- API 라우트는 서버가 필요하므로 정적 빌드와 충돌

**일반적인 프로젝트에서는**:
- ❌ 이런 스크립트가 필요 없음
- ✅ 서버가 있는 환경에서는 API 라우트 그대로 사용
- ✅ Vercel, Netlify 등 서버리스 플랫폼 사용 시 자동 처리

## 3. 업계 표준 방식

### 3.1 대규모 서비스 (Google Analytics, Mixpanel)
```
클라이언트 SDK → 배치 전송 → 서버 수집 → 데이터베이스 → 분석
```

### 3.2 중소규모 서비스
```
클라이언트 추적 → 직접 API 호출 → 데이터베이스 → 대시보드
```

### 3.3 현재 프로젝트
```
클라이언트 추적 → localStorage + 로컬 API → 분석
```

## 4. 권장 사항

### 4.1 프로덕션 환경
1. **전용 분석 서비스 사용** (Google Analytics, Mixpanel 등)
   - 검증된 인프라
   - 자동 확장
   - 풍부한 분석 기능

2. **자체 백엔드 구축**
   - 데이터베이스 (PostgreSQL, MongoDB)
   - API 서버 (Node.js, Python)
   - 실시간 분석 파이프라인

3. **하이브리드 클라우드 서비스**
   - Segment (이벤트 수집)
   - Amplitude (행동 분석)
   - Hotjar (세션 리플레이)

### 4.2 현재 방식의 개선점

**현재 방식의 장점**:
- ✅ 독립적인 구현 (외부 서비스 의존 없음)
- ✅ 데이터 소유권 보장
- ✅ 커스터마이징 자유도 높음

**개선이 필요한 부분**:
1. **데이터베이스 연동**
   - 현재: localStorage (임시)
   - 권장: PostgreSQL/MongoDB 연동 (Supabase 사용 예정)

2. **빌드 스크립트 제거**
   - 현재: API 라우트 임시 이동 (GitHub Pages 제약)
   - 권장: Vercel/Netlify 사용 또는 서버 환경 구축

3. **데이터 검증 및 정제**
   - 현재: 클라이언트에서만 처리
   - 권장: 서버 측 검증 추가

4. **실시간 분석**
   - 현재: 페이지 새로고침 시 분석
   - 권장: WebSocket 또는 Server-Sent Events

## 5. 결론

**현재 구현 방식 평가**:
- ✅ **행동 추적 로직**: 업계 표준 방식과 유사 (클라이언트 사이드)
- ⚠️ **빌드 스크립트**: 특수한 환경(GitHub Pages) 때문에 필요한 임시 방편
- ✅ **데이터 저장**: 다중 저장소 전략은 좋은 접근

**일반적인 프로덕션 환경에서는**:
- 빌드 스크립트 없이 API 라우트 그대로 사용
- 전용 데이터베이스 사용
- 서버 측 검증 및 분석 파이프라인 구축

**현재 방식은**:
- 프로토타입/데모 목적에는 적합
- 학습 및 개념 검증에는 우수
- 프로덕션 배포 전 개선 필요

